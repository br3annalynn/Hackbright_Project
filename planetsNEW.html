<html>
    <head>
        <title>Planets</title>
        <style>
            canvas { width: 100%; height: 100% }
            body{
                background-image: url('stars2.jpg');
            }
        </style>

    </head>
    <body>
        <script src="three.min.js"></script>
        <script>

            function buildScene(){
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 10000);
                renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
                camera.position.z = 1000;
               
            }

            function aPlanet(radius, image, distFromCenter, angleOfRot, isSun){
                this.radius = radius;
                this.image = image;
                this.distFromCenter = distFromCenter;
                this.planetGeom = null;
                //this.spaceObject = new aSpaceObject();
                this.rotAxis = null;
                this.angleOfRot = angleOfRot;
                this.angularSpeed = angleOfRot;
                this.isSun = isSun;
                //this.solarSystem = solarSystem;

                this.buildPlanet = function(){
                    var geometry = new THREE.SphereGeometry(this.radius, 16, 16);
                    var texture = new THREE.ImageUtils.loadTexture(this.image);
                    var material = new THREE.MeshBasicMaterial({map: texture});
                    var sphere = new THREE.Mesh(geometry, material);
                    this.planetGeom = sphere;
                    // scene.add(sphere);
                    //this.solarSystem.add(sphere);
                    return sphere;
                }

                this.rotAxis = function(){
                    if(this.isSun){
                        this.rotAxis = new THREE.Vector3(0, 1, 0).normalize();
                    }
                    else{
                        var vectora = Math.random();
                        var vectorb = Math.random()*2;
                        this.rotAxis = new THREE.Vector3(vectora, vectorb, 0.1).normalize();
                    }
                }

                this.setPosition = function(){
                    //set the planet to a start position 
                    this.planetGeom.position.x = this.distFromCenter;
                    
                }

                this.updateSpin = function(){
                    this.planetGeom.rotateOnAxis(this.rotAxis, this.angleOfRot);

                }
                
                /////////Parameterized version ////////////
                this.updateOrbit = function(){
                    
                    x_direction = this.distFromCenter*Math.cos(this.angularSpeed)*1 + this.distFromCenter*Math.sin(this.angularSpeed)*0;
                    y_direction = this.distFromCenter*Math.cos(this.angularSpeed)*0 + this.distFromCenter*Math.sin(this.angularSpeed)*0;
                    z_direction = this.distFromCenter*Math.cos(this.angularSpeed)*0 + this.distFromCenter*Math.sin(this.angularSpeed)*1;

                    this.planetGeom.position.x = x_direction;
                    this.planetGeom.position.y = y_direction;
                    this.planetGeom.position.z = z_direction;
                }
            }

            function aSolarSystem(numOfPlanets){
                this.numOfPlanets = numOfPlanets;
                this.solarSystemList = [];
                this.solarSystemGroup = null;

                this.buildSolarSystem = function(){
                    var group = new THREE.Object3D();
                    
                    //a number between 0 and 5.9;
                    var randInt = Math.floor(Math.random() * 6 -.1);

                    var sunImage = sunImages[randInt];
                    var sunAngle = -0.001;
                    var mySun = new aPlanet(100, sunImage, 0, sunAngle, true);
                    var sphere = mySun.buildPlanet();
                    mySun.rotAxis();
                    group.add(sphere);
                    this.solarSystemList.push(mySun);

                    for(var i = 0; i < this.numOfPlanets; i++){
                        //number between 0 and 5
                        var randInt2 = Math.floor(Math.random() * 6);
                        var planetImage = planetImages[randInt2];
                        //make speed slower the further out you go
                        var angle = (5 - i)/1000;
                        var distance = i *100 + 200;
                        var planet = new aPlanet((randInt2 + 1)*5, planetImage, distance, angle, false);
                        var planetSphere = planet.buildPlanet();
                        planet.rotAxis();
                        planet.setPosition();
                        group.add(planetSphere);
                        this.solarSystemList.push(planet);
                    }
                    this.solarSystemGroup = group;
                    return group;
                }
                
            }

            //this creates a loop that runs every 60th of a sec
            function render(){

                //spin and orbit each
                for(var i = 0; i < solarSystem1.solarSystemList.length; i++){
                    solarSystem1.solarSystemList[i].updateSpin();
                    solarSystem1.solarSystemList[i].angularSpeed += solarSystem1.solarSystemList[i].angleOfRot;
                    solarSystem1.solarSystemList[i].updateOrbit();
                }
                
                
                 
                for(var i = 0; i < solarSystem2.solarSystemList.length; i++){
                    solarSystem2.solarSystemList[i].updateSpin();
                    solarSystem2.solarSystemList[i].angularSpeed += solarSystem2.solarSystemList[i].angleOfRot;
                    solarSystem2.solarSystemList[i].updateOrbit();
                }
                
                
                 


                renderer.render(scene, camera);
                requestAnimationFrame(render);
            }
            

            ///////////////////////////////////////////////////////////////////////////////
            
            //global variables
            var scene, camera, renderer, solarSystem1, solarSystemGroup, solarSystem2, solarSystemGroup2;
            var sunImages = ['sun.jpg', 'sun.png', 'sun1.gif', 'sun2.jpeg', 'sun3.jpeg', 'sun.jpeg'];
            var planetImages = ['planet.jpg', 'planet2.png', 'planet1.jpg', 'planet3.jpeg', 'planet4.jpg', 'planet5.png'];
            
            function main(){

                //build scene
                sceneRendererCamera = buildScene();

                //define galaxy axis
                galaxyAxis = new THREE.Vector3(1, .25, 0.1).normalize()

                //build a solar system 
                solarSystem1 = new aSolarSystem(2);
                solarSystemGroup = solarSystem1.buildSolarSystem();
                solarSystemGroup.translateOnAxis(galaxyAxis, 300);
                //solarSystem.up = new THREE.Vector3(1, .25, 0);
                scene.add(solarSystemGroup);

                solarSystem2 = new aSolarSystem(3);
                solarSystemGroup2 = solarSystem2.buildSolarSystem();
                solarSystemGroup2.translateOnAxis(galaxyAxis, -400);
                //solarSystem.up = new THREE.Vector3(1, .25, 0);
                scene.add(solarSystemGroup2);

            
                render();

            }

            main();

        </script>
    </body>
</html>