<html>
    <head>
        <title>Planets</title>
        <style>
            canvas { width: 100%; height: 100% }
            body{
                background-image: url('stars2.jpg');
            }
        </style>

    </head>
    <body>
        <script src="three.min.js"></script>
        <script>

            function buildScene(){
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 10000);
                renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
                camera.position.z = 500;
               
            }

            // function aSpaceObject(){
            //     this.rotAxis = null;
               

            //     // this.rotAxis = function(){
            //     //     var vectora = Math.random();
            //     //     var vectorb = Math.random()*2;
            //     //     this.rotAxis = new THREE.Vector3(vectora, vectorb, 0.1).normalize();
            //     // }
                
            // }

            

            function aPlanet(radius, image, distFromCenter, angleOfRot, isSun){
                this.radius = radius;
                this.image = image;
                this.distFromCenter = distFromCenter;
                this.planetGeom = null;
                //this.spaceObject = new aSpaceObject();
                this.rotAxis = null;
                this.angleOfRot = angleOfRot;
                this.angularSpeed = angleOfRot;
                this.isSun = isSun;

                this.buildPlanet = function(){
                    var geometry = new THREE.SphereGeometry(this.radius, 16, 16);
                    var texture = new THREE.ImageUtils.loadTexture(this.image);
                    var material = new THREE.MeshBasicMaterial({map: texture});
                    var sphere = new THREE.Mesh(geometry, material);
                    this.planetGeom = sphere;
                    // scene.add(sphere);
                    solarSystem.add(sphere);
                }

                this.rotAxis = function(){
                    if(this.isSun){
                        this.rotAxis = new THREE.Vector3(0, 1, 0).normalize();
                    }
                    else{
                        var vectora = Math.random();
                        var vectorb = Math.random()*2;
                        this.rotAxis = new THREE.Vector3(vectora, vectorb, 0.1).normalize();
                    }
                }

                this.setPosition = function(){
                    //set the planet to a start position 
                    this.planetGeom.position.x = this.distFromCenter;

                }

                this.updateSpin = function(){
                    this.planetGeom.rotateOnAxis(this.rotAxis, this.angleOfRot);

                }

               
                
                /////////Parameterized version ////////////
                this.updateOrbit = function(){
                    
                    x_direction = this.distFromCenter*Math.cos(this.angularSpeed)*1 + this.distFromCenter*Math.sin(this.angularSpeed)*0;
                    y_direction = this.distFromCenter*Math.cos(this.angularSpeed)*0 + this.distFromCenter*Math.sin(this.angularSpeed)*0;
                    z_direction = this.distFromCenter*Math.cos(this.angularSpeed)*0 + this.distFromCenter*Math.sin(this.angularSpeed)*1;

                    this.planetGeom.position.x = x_direction;
                    this.planetGeom.position.y = y_direction;
                    this.planetGeom.position.z = z_direction;
                }
            }

            //this creates a loop that runs every 60th of a sec
            function render(){

                //spin each
                mySun.updateSpin();
                rPlanet.updateSpin();
                bPlanet.updateSpin();
              
                //orbit each planet
                rPlanet.angularSpeed += 0.005;
                rPlanet.updateOrbit();
                bPlanet.angularSpeed += 0.003;
                bPlanet.updateOrbit();

                //solarSystem.rotateOnAxis(new THREE.Vector3(1, 4, 0).normalize, 0.01);
                       
                renderer.render(scene, camera);
                requestAnimationFrame(render);
            }
            

            /////////////////////////////////////////
            
            //global variables
            var scene, camera, renderer, mySun, rPlanet, bPlanet, solarSystem;
            function main(){

                //build scene
                sceneRendererCamera = buildScene();

                solarSystem = new THREE.Object3D();

                //build each (radius, image, distFromCenter, angleOfRot)
                sunImage = "sun.png";
                sunAngle = -0.001;
                mySun = new aPlanet(100, sunImage, 0, sunAngle, true);
                mySun.buildPlanet();
                mySun.rotAxis();

                rPlanetImage = "Planet.jpg";
                redAngle = 0.005;
                rPlanet = new aPlanet(8, rPlanetImage, 200, redAngle, false);
                rPlanet.buildPlanet();
                rPlanet.rotAxis();
                
                bPlanetImage = "bplanet.jpg";
                blueAngle = 0.003;
                bPlanet = new aPlanet(30, bPlanetImage, 300, blueAngle, false);
                bPlanet.buildPlanet();
                bPlanet.rotAxis();

                scene.add(solarSystem);

                
                solarSystem.position.x = 100;
                // solarSystem.up.x = .5;
                // solarSystem.up.y = 8;


                //set initial planets 

                rPlanet.setPosition();
                bPlanet.setPosition();

                render();

            }

            main();

        </script>
    </body>
</html>