<html>
    <head>
        <title>Planets</title>
        <style>
            canvas { width: 100%; height: 100% }
            body{
                background-image: url('stars2.jpg');
            }
        </style>

    </head>
    <body>
        <script src="three.min.js"></script>
        <script>

            function buildScene(){
                var scene = new THREE.Scene();
                var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
                var renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
                camera.position.z = 400;
                return [scene, renderer, camera]
            }
            
            //make a planet or sun
            function buildPlanet(radius, image){
                var geometry = new THREE.SphereGeometry(radius, 16, 16);
                var texture = new THREE.ImageUtils.loadTexture(image);
                var material = new THREE.MeshBasicMaterial({map: texture});
                var planet = new THREE.Mesh(geometry, material);
                scene.add(planet);
                return planet
            }

            function rotatePlanetMatrix(angle){
                rot_mtx = new THREE.Matrix4;
                rot_mtx.makeRotationAxis(axis, angle);
                return rot_mtx;
            }

            function setPosition(planet, startingPoint){
                //set the red planet to a start position 

                planet.position.x = startingPoint[0];
                planet.position.y = startingPoint[1];
                planet.position.z = startingPoint[2];
            }

            function orbitPlanet(angle, distFromSun){
                x_direction = distFromSun*Math.cos(angle)*0.8945 + distFromSun*Math.sin(angle)*-0.412;
                y_direction = distFromSun*Math.cos(angle)*-0.472 + distFromSun*Math.sin(angle)*-0.0799;
                z_direction = distFromSun*Math.cos(angle)*0 + distFromSun*Math.sin(angle)*1.009;
                return [x_direction, y_direction, z_direction];
            }


            //this creates a loop that runs every 60th of a sec
            function render(){
                //spin each planet and sun 
                planet.applyMatrix(redRotationMatrix);
                bPlanet.applyMatrix(blueRotationMatrix);
                mySun.applyMatrix(sunRotationMatrix);
                
                //orbit each planet
                redAngle += 0.01;
                directions = orbitPlanet(redAngle, 100);
                planet.position.x = directions[0];
                planet.position.y = directions[1];
                planet.position.z = directions[2];

                blueAngle += 0.005;
                directions = orbitPlanet(blueAngle, 200);
                bPlanet.position.x = directions[0];
                bPlanet.position.y = directions[1];
                bPlanet.position.z = directions[2];
            
                renderer.render(scene, camera);

                requestAnimationFrame(render);
            }
            
            /////////////////////////////////////////
            //build scene
            sceneRendererCamera = buildScene();
            var scene = sceneRendererCamera[0];
            var renderer = sceneRendererCamera[1];
            var camera = sceneRendererCamera[2];

            //build planets
            sunImage = "sun.png";
            var mySun = buildPlanet(80, sunImage);

            planetImage = "planet.jpg";
            var planet = buildPlanet(10, planetImage);
            
            bPlanetImage = "bplanet.jpg";
            var bPlanet = buildPlanet(30, bPlanetImage);


            //make rotation matrices
            var axis = new THREE.Vector3(0.5, 1, 0.1)

            sunAngle = 0.001;
            redAngle = 0.01;
            blueAngle = 0.005;
            sunRotationMatrix = rotatePlanetMatrix(sunAngle);
            redRotationMatrix = rotatePlanetMatrix(redAngle);
            blueRotationMatrix = rotatePlanetMatrix(blueAngle);

            //set initial planets
            redPositions = [100, -50, 0];
            setPosition(planet, redPositions);
            bluePositions = [200, -100, 0];
            setPosition(bPlanet, bluePositions);

            render();
           
        

        </script>
    </body>
</html>